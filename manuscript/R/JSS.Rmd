---
title: "JSS"
author: "Jonathan Rosenblatt"
date: "May 29, 2016"
output: html_document
---

# Brazil Data Analysis

## MLE
```{r}
library(magrittr)
library(chords)
# Import data in RDS file format:
data(brazil)
head(brazil)

# Initialize RDS object:
rds.object<- initializeRdsObject(brazil)
# MLE Estimate:
rds.object <- Estimate.b.k(rds.object = rds.object )

# Get estimates:
plot(rds.object$estimates$Nk.estimates, type='h')
table(rds.object$estimates$Nk.estimates)

# How many degrees were imputed?:
table(rds.object$estimates$convergence)

# Recover theta assuming b.k=b_0*k^theta
getTheta(rds.object)
```

## Delete-d 
```{r}
jack.control <- makeJackControl(3, 1e2)
rds.object.2 <- Estimate.b.k(rds.object, type='leave-d-out', jack.control = jack.control)

estimate.2 <- rds.object.2$estimates$Nk.estimates
table(estimate.2)
sum(estimate.2)
```

## Parametric smoothing
```{r}
rds.object.3 <- Estimate.b.k(rds.object, type='parametric')

estimate.3 <- rds.object.3$estimates$Nk.estimates
plot(estimate.3, type='h')
table(estimate.3)
sum(estimate.3[estimate.3<Inf])
```

## Integrated MLE
```{r}
rds.object.4 <- Estimate.b.k(rds.object, type='integrated')

estimate.4 <- rds.object.4$estimates$Nk.estimates
plot(estimate.4, type='h')
table(estimate.4)
sum(estimate.4)

```


## Heuristic scaling




