---
title: "JSS"
author: "Jonathan Rosenblatt"
date: "May 29, 2016"
output: html_document
---

# Brazil Data Analysis

## MLE
```{r}
library(magrittr)
library(chords)
# Import data in RDS file format:
data(brazil)
# Initialize RDS object:
rds.object<- initializeRdsObject(brazil)
# MLE Estimate:
rds.object <- Estimate.b.k(rds.object = rds.object )

# Get estimates:
plot(rds.object$estimates$Nk.estimates, type='h')
table(rds.object$estimates$Nk.estimates)

# How many degrees were imputed?:
table(rds.object$estimates$convergence)

# Recover theta assuming b.k=b_0*k^theta
getTheta(rds.object)
```

## Integrated MLE
```{r}

```

## Delete-d 
```{r}
# Delete k estimator:
jack.control <- makeJackControl(3,1e3)
rds.object.2 <- Estimate.b.k(rds.object, type='leave-d-out')


n.deletions <- 1e3
N <- length(rds.object$I.t)

n.jack <- rep(NA, n.deletions)
for(i in 1:n.deletions){
  deletion <- sample(N, 3)
  rds.jack.estim <- estimate.b.k(rds.object, jack.ind = deletion, silent=TRUE)  
  n.jack[i] <- sum(rds.jack.estim$Nk.estimates)
}
n.jack
1/(mean(1/n.jack))



```

## Parametric smoothing

## Heuristic scaling




